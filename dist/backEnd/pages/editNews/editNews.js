angular.module("edit",["ngRoute"]).controller("editCtrl",["$scope","$http","$window","$routeParams","$route",function(t,e,n,a,o){var i=a.index?a.index:1;t.uname=n.name.split("&")[0],t.isShow=!1,t.changeData={},e({url:"http://127.0.0.1:9090/api/getnews",method:"get",params:{uname:t.uname,page:i}}).then(function(e){t.data=e.data,t.arr=[],t.count=n.Math.ceil(e.data.totalLength/5);for(var a=0;a<t.count;a++)t.arr[a]=a}).catch(function(t){console.log(t)}),t.search=function(){e({url:"http://127.0.0.1:9090/api/getkeynews",method:"get",params:{uname:t.uname,page:i,keys:t.keyWord}}).then(function(e){t.data=e.data,t.arr=[],t.count=n.Math.ceil(e.data.totalLength/5);for(var a=0;a<t.count;a++)t.arr[a]=a}).catch(function(t){console.log(t)})},t.pre=function(){0==--i&&(i=1),o.updateParams({index:i})},t.next=function(){++i==t.count+1&&(i=t.count),o.updateParams({index:i})},t.edit=function(n){e({url:"http://127.0.0.1:9090/api/getchangenews",method:"get",params:{uname:t.uname,timestamp:n}}).then(function(e){t.editShow(e.data[0].content+e.data[0].imgArr),t.isShow=!0,t.changeData=e.data[0]}).catch(function(t){console.log(t)})},t.del=function(a){e({url:"http://127.0.0.1:9090/api/deletenews",method:"get",params:{uname:t.uname,timestamp:a}}).then(function(t){n.location.reload()}).catch(function(t){console.log(t)})},t.editShow=function(t){$.getScript("./js/kindeditor-4.1.10/kindeditor-min.js",function(){KindEditor.basePath="./js/kindeditor-4.1.10/";var e={filterMode:!1,designMode:!0};n.editor=KindEditor.create("#editor_id",e),n.editor.html(t),n.editor.sync()})}}]);